import os
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
import datetime

def create_guarantee(number_dogovoru, description, manufacturer, folder_path):
    # Перевірка коректності аргументів
    if not (number_dogovoru and description and manufacturer and folder_path):
        raise ValueError("Всі аргументи повинні бути заповнені.")

    # Перевірка, чи існує директорія для збереження
    if not os.path.exists(folder_path):
        raise FileNotFoundError(f"Директорія для збереження не існує: {folder_path}")

    current_date = datetime.datetime.now().strftime('%d.%m.%Y')

    # Створення документа
    doc = Document()
    doc.styles['Normal'].font.name = 'Times New Roman'
    doc.styles['Normal'].font.size = Pt(9)

    # Додати заголовок
    title = doc.add_paragraph()
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER
    run = title.add_run(f"ГАРАНТІЯ ТА ПІСЛЯГАРАНТІЙНЕ ОБСЛУГОВУВАННЯ {number_dogovoru}-1 від {current_date}")
    run.bold = True

    doc.add_paragraph(f"\n{description}\n")

    # Пункти гарантії
    doc.add_paragraph(
        "1. Гарантійний термін меблів: продавець надає гарантію на експлуатацію продукції терміном на 1.5 роки. Гарантійний термін починається з дати зазначеної в документі купівлі-продажу м’яких меблів.\nОбмін товару належної якості проводиться якщо він не використовувався і якщо збережено його товарний вигляд споживчі властивості а також розрахунковий документ виданий споживачеві разом з проданим товаром."
    )

    doc.add_paragraph(
        "2. На що поширюється гарантія?\nГарантія діє тільки в разі побутового використання товару і поширюється на випадки дефектів матеріалу і виробничого браку (каркас, оббивка).\nПраво гарантійного обслуговування належить покупцеві і не підлягає передачі третім особам."
    )

    doc.add_paragraph(
        "3. Гарантія не діє якщо:\n- якщо збирання монтаж ремонт меблів здійснювались самостійно чи/або третіми особами не рекомендованими Продавцем внаслідок чого виникли будь які механічні пошкодження дефекти тощо;\n- меблі знаходиться у вологому приміщенні або піддаються шкідливому атмосферному впливу;\n- меблі використовується не за призначенням;\n- при догляді за меблями використовувалися засоби для чищення порошки або розчинники які для цього не призначені;\n- відновлення та ремонт меблів здійснювався Замовником самостійно;\n- меблі пошкоджена в результаті дії домашніх тварин вогню агресивних рідин а також з ознаками недбалого поводження.\nГарантія не поширюється на нормальний знос, порізи і подряпини а також на ушкодження які виникли в результаті удару або інциденту."
    )

    doc.add_paragraph(
        "4. Повернення товару.\nСпоживач має право обміняти непродовольчий товар належної якості на аналогічний у продавця у якого він був придбаний протягом чотирнадцяти днів не рахуючи дня покупки якщо товар не відповідає специфікації а саме п. 1.2. в документі купівлі-продажу м’яких меблів."
    )

    doc.add_paragraph(
        "5. Всі транспортні витрати по гарантійному та після гарантійному обслуговуванню сплачуються Замовником."
    )

    doc.add_paragraph(f"\nВИРОБНИК:\n Фабрика “{manufacturer}”\n")

    doc.add_paragraph("ПРОДАВЕЦЬ:\nФО-П Журавльов Олександр Володимирович\nАТ КБ «ПриватБанк» м. Київ Код: 3274319113")

    # Додавання печатки та підпису
    doc.add_paragraph("\nПечатка:\t\t\tПідпис: ___________")

    # Збереження документу
    file_name = f"Гарантія_{number_dogovoru}_{manufacturer}.docx"
    file_path = os.path.join(folder_path, file_name)
    doc.save(file_path)

    print(f"Гарантія успішно створена у: {file_path}")
    return file_path
